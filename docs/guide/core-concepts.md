# 核心概念

Hyper Scheduler 的设计围绕几个核心概念展开。理解这些概念有助于你更高效地使用本库。

## 调度器 (Scheduler)

`Scheduler` 是整个系统的核心控制器。它负责管理所有的任务，维护时间循环（Timer Loop），并在准确的时间点触发任务处理器。

- **单例模式**: 通常一个应用只需要一个 `Scheduler` 实例，但你也支持创建多个实例以隔离不同类型的任务。
- **生命周期**: 支持 `start()`（启动）、`stop()`（暂停/停止）等控制方法。

## 任务 (Task)

任务是调度的基本单元。一个任务定义包含以下要素：

- **ID**: 任务的唯一标识符，用于后续的管理（如移除任务）。
- **Schedule (调度规则)**: 定义任务何时执行。
- **Handler (处理器)**: 任务触发时执行的回调函数。支持同步和异步函数。

## 调度规则 (Schedule)

Hyper Scheduler 支持两种灵活的调度规则定义方式：

### 1. Cron 表达式
基于标准的 Linux Cron 语法，适用于通过绝对时间点控制任务。

- 格式: `分 时 日 月 周`
- 示例:
  - `* * * * *`: 每分钟
  - `30 8 * * *`: 每天上午 8:30
  - `0 0 1 * *`: 每月 1 号零点

### 2. 时间间隔 (Interval)
基于相对时间间隔，适用于循环执行的任务。

- 格式: `数字 + 单位`
- 支持单位:
  - `s`: 秒
  - `m`: 分
  - `h`: 时
  - `d`: 天
- 示例:
  - `30s`: 每 30 秒
  - `5m`: 每 5 分钟
  - `2h`: 每 2 小时

## 计时策略 (Timer Strategy)

为了适应不同的运行环境，Hyper Scheduler 实现了适配器模式的计时策略：

- **NodeTimer**: 在 Node.js 环境下，使用 `setTimeout` / `setInterval` 结合 `process.hrtime` 实现高精度计时。
- **BrowserTimer**: 在浏览器环境下，默认尝试使用 **Web Worker** 运行计时循环。这是为了解决浏览器后台页面标签页（Inactive Tab）会将主线程 `setTimeout` 节流至 1 秒甚至更久的问题。Web Worker 在后台通常拥有更高的优先级，保证任务准时触发。
